<div class="contenus-container">
  <div class="container-left">
    <div class="optionsNiveau">
      @for (niveau of niveau; track $index){
        <app-button
          label= "{{niveau.niveau.charAt(0).toUpperCase()}}{{niveau.niveau.slice(1).toLowerCase()}}"
          color="primary"
          icon="trash"
          type="button"
          [disabled] = false
          largeur="flex: 1"
          (click)="setActiveNiveau(niveau.niveau.charAt(0).toUpperCase() + niveau.niveau.slice(1).toLowerCase())"
          (click)="findCoursByLevel(niveau.niveau, 'LINGUSTIQUE')"
          (click)="setActive('Cours ' + this.coursPerLevel[0].id)"
          (click)="setActiveCoursNom('Cours ' + 1)"
          (click)="setActiveLessonNom('chapitre ' + 1)"
          (click)="findChapitreByCours(this.coursPerLevel[0].id)"
          (click)="findcContenuByChapitre(this.chapitrePerCours[0].id)"
          (click)="setActiveLesson('Lesson ' + 1, chapitrePerCours[0])"
        >
        </app-button>
      }
    </div>
    @if (activeNiveau == "Debutant"){
      <div class="conteneurCours">
        @if(niveau){
          @for (cour of coursPerLevel; track $index)
          {
            <div class="cours menu">
              <div class="beforeDrop">
                <div class="icon-titre"
                     (click)="setActive('Cours ' + cour.id)"
                     (click)="setActiveCoursNom('Cours ' + ($index + 1))"
                     (click)="setActiveLessonNom('chapitre ' + 1)"
                     (click)="findChapitreByCours(cour.id)"
                     (click)="setActiveLesson('Lesson ' + 1, chapitrePerCours[0])"
                     (click)="findcContenuByChapitre(this.activeChapitre.id)"
                     [ngClass]="{'active': activeCours === 'Cours ' + cour.id}"
                >

                  <div class="menu-titre" (click)="openDropdown()">
                    <p>Cours {{ $index + 1}}</p>
                  </div>
                  <div class="menu-icon">
                    @if (isDropdownOpen == true && activeCours === 'Cours ' + cour.id){
                      <ion-icon name="chevron-up" size="large" class="chevron" (click)="hideDropdown()"></ion-icon>
                    }
                    @if (isDropdownOpen == false || activeCours !== 'Cours ' + cour.id && chapitrePerCours.length > 0){
                      <ion-icon name="chevron-down" size="large" class="chevron" (click)="openDropdown()"></ion-icon>
                    }
                  </div>
                </div>
                <div class="menu-icon">
                  <ion-icon name="ellipsis-vertical" size="large" class="menu-drop" style="color: var(--couleur-main)"></ion-icon>
                </div>
              </div>
              <!-- Sous-options du menu déroulant -->
              @if (isDropdownOpen && activeCours === 'Cours ' + cour.id && chapitrePerCours.length > 0){
                <div class="lesson-menu">
                  @for (chapitre of chapitrePerCours; track $index){
                    <div class="beforeDrop">
                      <div class="icon-titre"
                           (click)="setActiveLesson('Lesson ' + chapitre.id, chapitre)"
                           (click)="setActiveLessonNom('chapitre ' + ($index + 1))"
                           (click)="findcContenuByChapitre(this.activeChapitre.id)"
                           [ngClass]="{'active': activeLesson === 'Lesson ' + chapitre.id && activeCours === 'Cours ' + cour.id}">
                        <div class="menu-titre" (click)="openDropdown()">
                          <p>chapitre {{ $index + 1 }}</p>
                        </div>
                      </div>
                      <div class="menu-icon">
                        <ion-icon name="ellipsis-vertical" size="large" class="menu-drop" style="color: var(--couleur-main)"></ion-icon>
                      </div>
                    </div>
                  }
                </div>
              }
            </div>
          }
        }
        <!--<div class="cours menu">
          <div class="beforeDrop">
            <div class="icon-titre" (click)="setActive('Cours 2')" (click)="setActiveLesson('Lesson 1')" [ngClass]="{'active': activeCours === 'Cours 2'}">
              <div class="menu-titre" (click)="openDropdown()">
                <p >Cours 2</p>
              </div>
              <div class="menu-icon">
                @if (isDropdownOpen == true && activeCours === 'Cours 2'){
                  <ion-icon name="chevron-up" size="large" class="chevron" (click)="hideDropdown()"></ion-icon>
                }
                @if (isDropdownOpen == false || activeCours !== 'Cours 2'){
                  <ion-icon name="chevron-down" size="large" class="chevron" (click)="openDropdown()"></ion-icon>
                }
              </div>
            </div>
            <div class="menu-icon">
              <ion-icon name="ellipsis-vertical" size="large" class="menu-drop" style="color: var(&#45;&#45;couleur-main)"></ion-icon>
            </div>
          </div>
          &lt;!&ndash; Sous-options du menu déroulant &ndash;&gt;
          @if (isDropdownOpen && activeCours === 'Cours 2'){
            <div class="lesson-menu">
              <div class="beforeDrop">
                <div class="icon-titre" (click)="setActiveLesson('Lesson 1')"  [ngClass]="{'active': activeLesson === 'Lesson 1' && activeCours === 'Cours 2'}">
                  <div class="menu-titre" (click)="openDropdown()">
                    <p>Leçon 1</p>
                  </div>
                </div>
                <div class="menu-icon">
                  <ion-icon name="ellipsis-vertical" size="large" class="menu-drop" style="color: var(&#45;&#45;couleur-main)"></ion-icon>
                </div>
              </div>
              <div class="beforeDrop">
                <div class="icon-titre" (click)="setActiveLesson('Lesson 2')"  [ngClass]="{'active': activeLesson === 'Lesson 2' && activeCours === 'Cours 2'}">
                  <div class="menu-titre" (click)="openDropdown()">
                    <p>Leçon 2</p>
                  </div>
                </div>
                <div class="menu-icon">
                  <ion-icon name="ellipsis-vertical" size="large" class="menu-drop" style="color: var(&#45;&#45;couleur-main)"></ion-icon>
                </div>
              </div>
            </div>
          }
        </div>-->
      </div>
    }
    @if (activeNiveau == "Intermediaire"){
      <div class="conteneurCours">
        @if(niveau){
          @for (cour of coursPerLevel; track $index)
          {
            <div class="cours menu">
              <div class="beforeDrop">
                <div class="icon-titre"
                     (click)="setActive('Cours ' + cour.id)"
                     (click)="setActiveCoursNom('Cours ' + ($index + 1))"
                     (click)="setActiveLessonNom('chapitre ' + 1)"
                     (click)="findChapitreByCours(cour.id)"
                     (click)="setActiveLesson('Lesson ' + 1, chapitrePerCours[0])"
                     (click)="findcContenuByChapitre(this.activeChapitre.id)"
                     [ngClass]="{'active': activeCours === 'Cours ' + cour.id}"
                >

                  <div class="menu-titre" (click)="openDropdown()">
                    <p>Cours {{ $index + 1}}</p>
                  </div>
                  <div class="menu-icon">
                    @if (isDropdownOpen == true && activeCours === 'Cours ' + cour.id){
                      <ion-icon name="chevron-up" size="large" class="chevron" (click)="hideDropdown()"></ion-icon>
                    }
                    @if (isDropdownOpen == false || activeCours !== 'Cours ' + cour.id && chapitrePerCours.length > 0){
                      <ion-icon name="chevron-down" size="large" class="chevron" (click)="openDropdown()"></ion-icon>
                    }
                  </div>
                </div>
                <div class="menu-icon">
                  <ion-icon name="ellipsis-vertical" size="large" class="menu-drop" style="color: var(--couleur-main)"></ion-icon>
                </div>
              </div>
              <!-- Sous-options du menu déroulant -->
              @if (isDropdownOpen && activeCours === 'Cours ' + cour.id && chapitrePerCours.length > 0){
                <div class="lesson-menu">
                  @for (chapitre of chapitrePerCours; track $index){
                    <div class="beforeDrop">
                      <div class="icon-titre"
                           (click)="setActiveLesson('Lesson ' + chapitre.id, chapitre)"
                           (click)="setActiveLessonNom('chapitre ' + ($index + 1))"
                           (click)="findcContenuByChapitre(this.activeChapitre.id)"
                           [ngClass]="{'active': activeLesson === 'Lesson ' + chapitre.id && activeCours === 'Cours ' + cour.id}">
                        <div class="menu-titre" (click)="openDropdown()">
                          <p>chapitre {{ $index + 1 }}</p>
                        </div>
                      </div>
                      <div class="menu-icon">
                        <ion-icon name="ellipsis-vertical" size="large" class="menu-drop" style="color: var(--couleur-main)"></ion-icon>
                      </div>
                    </div>
                  }
                </div>
              }
            </div>
          }
        }
        <!--<div class="cours menu">
          <div class="beforeDrop">
            <div class="icon-titre" (click)="setActive('Cours 2')" (click)="setActiveLesson('Lesson 1')" [ngClass]="{'active': activeCours === 'Cours 2'}">
              <div class="menu-titre" (click)="openDropdown()">
                <p >Cours 2</p>
              </div>
              <div class="menu-icon">
                @if (isDropdownOpen == true && activeCours === 'Cours 2'){
                  <ion-icon name="chevron-up" size="large" class="chevron" (click)="hideDropdown()"></ion-icon>
                }
                @if (isDropdownOpen == false || activeCours !== 'Cours 2'){
                  <ion-icon name="chevron-down" size="large" class="chevron" (click)="openDropdown()"></ion-icon>
                }
              </div>
            </div>
            <div class="menu-icon">
              <ion-icon name="ellipsis-vertical" size="large" class="menu-drop" style="color: var(&#45;&#45;couleur-main)"></ion-icon>
            </div>
          </div>
          &lt;!&ndash; Sous-options du menu déroulant &ndash;&gt;
          @if (isDropdownOpen && activeCours === 'Cours 2'){
            <div class="lesson-menu">
              <div class="beforeDrop">
                <div class="icon-titre" (click)="setActiveLesson('Lesson 1')"  [ngClass]="{'active': activeLesson === 'Lesson 1' && activeCours === 'Cours 2'}">
                  <div class="menu-titre" (click)="openDropdown()">
                    <p>Leçon 1</p>
                  </div>
                </div>
                <div class="menu-icon">
                  <ion-icon name="ellipsis-vertical" size="large" class="menu-drop" style="color: var(&#45;&#45;couleur-main)"></ion-icon>
                </div>
              </div>
              <div class="beforeDrop">
                <div class="icon-titre" (click)="setActiveLesson('Lesson 2')"  [ngClass]="{'active': activeLesson === 'Lesson 2' && activeCours === 'Cours 2'}">
                  <div class="menu-titre" (click)="openDropdown()">
                    <p>Leçon 2</p>
                  </div>
                </div>
                <div class="menu-icon">
                  <ion-icon name="ellipsis-vertical" size="large" class="menu-drop" style="color: var(&#45;&#45;couleur-main)"></ion-icon>
                </div>
              </div>
            </div>
          }
        </div>-->
      </div>
    }
    @if (activeNiveau == "Avance"){
      <div class="conteneurCours">
        @if(niveau){
          @for (cour of coursPerLevel; track $index)
          {
            <div class="cours menu">
              <div class="beforeDrop">
                <div class="icon-titre"
                     (click)="setActive('Cours ' + cour.id)"
                     (click)="setActiveCoursNom('Cours ' + ($index + 1))"
                     (click)="setActiveLessonNom('chapitre ' + 1)"
                     (click)="findChapitreByCours(cour.id)"
                     (click)="setActiveLesson('Lesson ' + 1, chapitrePerCours[0])"
                     (click)="findcContenuByChapitre(this.activeChapitre.id)"
                     [ngClass]="{'active': activeCours === 'Cours ' + cour.id}"
                >

                  <div class="menu-titre" (click)="openDropdown()">
                    <p>Cours {{ $index + 1}}</p>
                  </div>
                  <div class="menu-icon">
                    @if (isDropdownOpen == true && activeCours === 'Cours ' + cour.id){
                      <ion-icon name="chevron-up" size="large" class="chevron" (click)="hideDropdown()"></ion-icon>
                    }
                    @if (isDropdownOpen == false || activeCours !== 'Cours ' + cour.id && chapitrePerCours.length > 0){
                      <ion-icon name="chevron-down" size="large" class="chevron" (click)="openDropdown()"></ion-icon>
                    }
                  </div>
                </div>
                <div class="menu-icon">
                  <ion-icon name="ellipsis-vertical" size="large" class="menu-drop" style="color: var(--couleur-main)"></ion-icon>
                </div>
              </div>
              <!-- Sous-options du menu déroulant -->
              @if (isDropdownOpen && activeCours === 'Cours ' + cour.id && chapitrePerCours.length > 0){
                <div class="lesson-menu">
                  @for (chapitre of chapitrePerCours; track $index){
                    <div class="beforeDrop">
                      <div class="icon-titre"
                           (click)="setActiveLesson('Lesson ' + chapitre.id, chapitre)"
                           (click)="setActiveLessonNom('chapitre ' + ($index + 1))"
                           (click)="findcContenuByChapitre(this.activeChapitre.id)"
                           [ngClass]="{'active': activeLesson === 'Lesson ' + chapitre.id && activeCours === 'Cours ' + cour.id}">
                        <div class="menu-titre" (click)="openDropdown()">
                          <p>chapitre {{ $index + 1 }}</p>
                        </div>
                      </div>
                      <div class="menu-icon">
                        <ion-icon name="ellipsis-vertical" size="large" class="menu-drop" style="color: var(--couleur-main)"></ion-icon>
                      </div>
                    </div>
                  }
                </div>
              }
            </div>
          }
        }
        <!--<div class="cours menu">
          <div class="beforeDrop">
            <div class="icon-titre" (click)="setActive('Cours 2')" (click)="setActiveLesson('Lesson 1')" [ngClass]="{'active': activeCours === 'Cours 2'}">
              <div class="menu-titre" (click)="openDropdown()">
                <p >Cours 2</p>
              </div>
              <div class="menu-icon">
                @if (isDropdownOpen == true && activeCours === 'Cours 2'){
                  <ion-icon name="chevron-up" size="large" class="chevron" (click)="hideDropdown()"></ion-icon>
                }
                @if (isDropdownOpen == false || activeCours !== 'Cours 2'){
                  <ion-icon name="chevron-down" size="large" class="chevron" (click)="openDropdown()"></ion-icon>
                }
              </div>
            </div>
            <div class="menu-icon">
              <ion-icon name="ellipsis-vertical" size="large" class="menu-drop" style="color: var(&#45;&#45;couleur-main)"></ion-icon>
            </div>
          </div>
          &lt;!&ndash; Sous-options du menu déroulant &ndash;&gt;
          @if (isDropdownOpen && activeCours === 'Cours 2'){
            <div class="lesson-menu">
              <div class="beforeDrop">
                <div class="icon-titre" (click)="setActiveLesson('Lesson 1')"  [ngClass]="{'active': activeLesson === 'Lesson 1' && activeCours === 'Cours 2'}">
                  <div class="menu-titre" (click)="openDropdown()">
                    <p>Leçon 1</p>
                  </div>
                </div>
                <div class="menu-icon">
                  <ion-icon name="ellipsis-vertical" size="large" class="menu-drop" style="color: var(&#45;&#45;couleur-main)"></ion-icon>
                </div>
              </div>
              <div class="beforeDrop">
                <div class="icon-titre" (click)="setActiveLesson('Lesson 2')"  [ngClass]="{'active': activeLesson === 'Lesson 2' && activeCours === 'Cours 2'}">
                  <div class="menu-titre" (click)="openDropdown()">
                    <p>Leçon 2</p>
                  </div>
                </div>
                <div class="menu-icon">
                  <ion-icon name="ellipsis-vertical" size="large" class="menu-drop" style="color: var(&#45;&#45;couleur-main)"></ion-icon>
                </div>
              </div>
            </div>
          }
        </div>-->
      </div>
    }
  </div>
  <div class="container-right">
    <div class="container-right-en-tete">
      <div class="breadcrumb">
        <!--Fil d'ariane-->
        <!--@if(activeNiveau){
          <div class="breadcrumb-titre" >
            <div class="breadcrumb-menu-titre" (click)="openDropdown()">
              <p >{{ activeNiveau }}</p>
            </div>
            <div class="breadcrumb-menu-icon">
              <ion-icon name="chevron-forward" size="large" class="arrow-forward"></ion-icon>
            </div>
          </div>
        }
        @if(activeCours){
          <div class="breadcrumb-titre" >
            <div class="breadcrumb-menu-titre" (click)="openDropdown()">
              <p >{{activeCoursNom}}</p>
            </div>
            <div class="breadcrumb-menu-icon">
              <ion-icon name="chevron-forward" size="large" class="arrow-forward"></ion-icon>
            </div>
          </div>
        }
        @if(activeLesson){
          <div class="breadcrumb-titre" >
            <div class="breadcrumb-menu-titre" (click)="openDropdown()">
              <p >{{activeLessonNom}}</p>
            </div>
          </div>
        }-->
        <div class="breadcrumb-titre" >
          <div class="breadcrumb-menu-titre" (click)="openDropdown()">
            <p >{{ activeNiveau }}</p>
          </div>
          <div class="breadcrumb-menu-icon">
            <ion-icon name="chevron-forward" size="large" class="arrow-forward"></ion-icon>
          </div>
        </div>
        <div class="breadcrumb-titre" >
          <div class="breadcrumb-menu-titre" (click)="openDropdown()">
            <p >{{activeCoursNom}}</p>
          </div>
          <div class="breadcrumb-menu-icon">
            <ion-icon name="chevron-forward" size="large" class="arrow-forward"></ion-icon>
          </div>
        </div>
        <div class="breadcrumb-titre" >
          <div class="breadcrumb-menu-titre" (click)="openDropdown()">
            <p >{{activeLessonNom}}</p>
          </div>
        </div>
      </div>
      <app-button
        label= "Modifier"
        color="primary"
        icon="trash"
        type="button"
        [disabled] = false
        largeur="flex: 1"
      >
      </app-button>
      <app-button
        label= "Test Associé"
        color="primary"
        icon="trash"
        type="button"
        [disabled] = false
        largeur="flex: 1"
      >
      </app-button>
    </div>
    <div class="cours-datils" >
      <div class="titre-element">
        <p><strong style="color: black">Titre : </strong>{{activeChapitre.titre}}</p>
        <div class="menu-icon">
          <ion-icon name="refresh" size="large" class="menu-drop"></ion-icon>
        </div>
      </div>
      <div class="ligne" style="width:100%; height: 0px; border: 1px #E1E1E1 solid"></div>
      <div class="resume-element">
        <p><strong style="color: black">Resumé : </strong>{{activeChapitre.resume}}</p>
      </div>
    </div>
    @if(contenuPerChapitre){
      @for (contenu of contenuPerChapitre; track $index)
      {
        <div class="contenu-datils" >
          <div class="titre-contenu">
            <p><strong style="color: black">Sous-titre : </strong>{{contenu.titre}}</p>
            <div class="menu-icon">
              <ion-icon name="volume-high" size="large" class="menu-drop"></ion-icon>
            </div>
            <div class="menu-icon">
              <ion-icon name="refresh" size="large" class="menu-drop"></ion-icon>
            </div>
          </div>
          <div class="ligne" style="width:100%; height: 0px; border: 1px #E1E1E1 solid"></div>
          <div class="contenu">
            <div class="fichier">
              <img [src]="'http://localhost:8080/sigidaKanw/drive/getFile/' + contenu.files[0].idFile" />
            </div>
            <p><strong style="color: black">Contenu : </strong>{{contenu.description}}</p>
          </div>
        </div>
      }
    }
  </div>
</div>
